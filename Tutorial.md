# Anywhere 使用教程

欢迎来到 Anywhere 的使用教程！本指南将详细介绍如何配置和使用 Anywhere，帮助你充分利用它的强大功能。

---

## ⚙️ 设置页面概览

Anywhere 的核心配置都集中在设置页面，可以在这里管理AI服务服务商、调整通用设置以及自定义提示词。

### 1. 服务商设置

服务商页面是连接AI模型的入口。

*   **添加服务商**：
    *   点击 `添加服务商` 按钮，可以添加新的AI服务服务商。Anywhere 支持与 OpenAI API 兼容的各种服务。
    *   填写 `API 密钥` 和 `API URL`。
    *   点击 `Get Models`，Anywhere 将从该服务商获取可用的模型列表。可以从中选择并添加到模型列表中。
*   **添加自定义模型**：
    *   点击 `从 API 获取模型` 按钮，可以手动设置一个自定义模型名称。
*   **多密钥轮询**：
    *   在 `API 密钥` 字段中，可以通过使用**英文逗号**分隔的方式，同时填入多个API密钥。Anywhere 将自动轮询这些密钥以确保服务的可用性。

![服务商设置页面](image/s2.png)
*图示：服务商设置界面，显示添加服务商、API配置及模型选择。*

---

### 2. 通用设置

这些设置将影响 Anywhere 的整体操作行为，可以根据个人习惯进行调整。

![通用设置页面](image/s3.png)
*图示：通用设置界面，展示各项功能开关及数据管理、窗口尺寸设置。*

*   **语言**：
    *   选择 Anywhere 应用界面的显示语言。
*   **流式响应 (Stream)**：
    *   若启用，AI的回复将以流式（即文字逐个显示）方式展现，提供更流畅的交互体验。
    *   若禁用，AI回复会在全部生成完成后一次性显示。
    *   *即使此项禁用，若在提示词的 `显示模式` 中选择 `输入框`，Anywhere 仍会通过 Utools API 以流式效果将内容输入到当前文本框，但本质上仍是非流式请求。*
*   **深色模式 (独立窗口)**：
    *   若启用，独立的AI响应窗口将使用深色模式主题。
*   **失焦时自动关闭窗口 (Auto CloseOnBlur)**：
    *   *此功能主要在提示词的 `显示模式` 选择 `独立窗口` 时有效。*
    *   若启用，当独立的AI响应窗口失去焦点（即点击窗口以外的任何区域）时，该窗口将自动关闭，实现“即用即走”的效果。
    *   若禁用，窗口将保持打开状态，直到手动关闭。
*   **发送时跳过换行符 (Skip LineBreak)**：
    *   若启用，当划选多行文本作为输入时，Anywhere 会自动删除文本中的换行符再发送给AI。这在翻译等多行内容需要连接起来的场景中非常有用。
    *   若禁用，则保留文本中的所有换行符。
*   **Ctrl+Enter 发送 (Ctrl+Enter to Send)**：
    *   *此功能主要在提示词的 `显示模式` 选择 `独立窗口` 时有效。*
    *   若启用），在窗口模式下，需要按下 `Ctrl+Enter` 键来发送问题。
    *   若禁用，只需按下 `Enter` 键即可发送问题。
*   **显示成功通知 (Success Notification)**：
    *   若启用，当AI回复完成后，系统会弹出通知提示。
    *   若禁用，则不会弹出通知。
    *   *在 `独立窗口` 模式下，只有首次请求会触发成功通知，后续追问不再显示。*
*   **固定窗口位置**：
    *   若启用，可以固定对话窗口在屏幕上出现的默认位置。可以在窗口模式下，点击模型名称左侧图标来更新此位置。
*   **数据管理**
    *   **导出配置**：将当前所有设置导出为 JSON 文件。**请注意，配置文件包含敏感信息（如API密钥），切勿随意分享！**
    *   **导入配置**：从 JSON 文件导入设置，这将覆盖当前的Anywhere设置，可以配置**WebDAV**同步。
*   **窗口尺寸**
    *   **窗口宽度 (px)**：设置独立响应窗口的默认宽度（以像素为单位）。默认值：532。
    *   **窗口高度 (px)**：设置独立响应窗口的默认高度（以像素为单位）。默认值：575。
    *   *也可以在窗口模式下，点击模型名称左侧图标来更新当前默认的窗口尺寸。*

---

### 3. 提示词设置【快捷助手】

提示词是 Anywhere 实现各种智能工具的核心。可以自定义不同的提示词来完成 OCR、翻译、代码解释、变量命名等多种功能。

![提示词设置页面1](image/s0.png)
![提示词设置页面2](image/s1.png)
*图示：提示词设置界面，显示添加提示词、设置`新增快捷助手`、`类型`、`显示模式`、`快捷助手内容`和`模型`选项。*

*   **`新增快捷助手` (添加提示词)**：位于底部左侧，点击即可新建一个提示词。
*   **`快捷助手名称` (提示词名称)**：
    *   这是自定义的提示词的名称，用于在 Utools 菜单中调用。例如`OCR`、`Translate`、`全能助手`等。
    *   设置的 `快捷助手名称` 将自动生成对应的 Utools 匹配指令。可以在 Utools 的快捷设置中为这些指令设置全局快捷键，以便更便捷地调用。
    ![Utools快捷键设置](image/t5.png)
    *图示：Utools快捷键设置示例，展示如何为Anywhere的提示词Key设置快捷键。*
*   **`类型` (调用类型)**：定义该提示词的触发方式。
    *   `通用`：当框选文本或截图后，呼出 Utools 菜单，Anywhere 会将选中文本、截图、文件作为输入。
    *   `文本`：**仅在选择文本后**，呼出 Utools 菜单，Anywhere 会自动将选择的文本作为输入发送给AI。
    *   `图片`：**仅在截图后**，呼出 Utools 菜单，Anywhere 会自动将选择的截图作为输入发送给AI。
    ![调用类型示例](image/t6.png)
    *   `文件`：**选中文件**，呼出 Utools 菜单，Anywhere 会自动将选择的文件（图片文件也是该类型）为输入发送给AI（选中保存的对话将会直接打开之前的对话）。
*   **`显示模式` (展示模式)**：定义AI回复结果的显示方式。
    *   `input`：AI的输出结果会直接显示在当前聚焦的输入框中。这使得AI能够直接协助进行文本输入或内容补全。
        *   *请确保在调用此功能时，的光标正聚焦在一个可编辑的输入框中。*
    *   `window`：AI的输出结果将以一个独立的窗口形式展示。此模式支持多轮对话追问。
*   **`快捷助手内容` (系统提示词)**：可以在此处设置AI的系统提示词。AI将根据设定的提示词要求进行回复，例如限定角色、语气或回答格式。
*   **`模型` (AI模型)**：设置执行该提示词所使用的具体AI模型。默认为第一个服务提供商的第一个模型 。

---

## 🛠️ 工具使用模式

Anywhere 提供了两种主要的工具使用模式，以适应不同的工作流程。

### 1. 输入框模式（剪切板模式类似）

在这种模式下，AI的回复将直接“输入”到当前活跃的文本编辑区域。

*   **操作流程**：
    1.  选中需要处理的文字或复制图片。
    2.  将光标移动到希望AI回复内容出现的目标输入框（例如：浏览器搜索栏、笔记应用、代码编辑器等），并确保该输入框处于聚焦状态。
    3.  调用 `显示模式` 设置为 `输入框` 的快捷助手 （通过 Utools 快捷键或菜单）。
*   **效果**：AI的输出结果会直接模拟键盘输入，显示在当前聚焦的输入框中。

![输入框模式展示](image/t7.png)
*图示：输入框模式下AI回复直接键入到当前输入框中。*

### 2. 独立窗口模式

这种模式下，AI的回复会显示在一个独立的对话窗口中，支持更复杂的交互。

*   **操作流程**：
    1.  选中需要处理的文字或截图。
    2.  调用 `显示模式` 设置为 `独立窗口` 的提示词 `Key`。
    3.  Anywhere 将弹出一个独立的对话窗口，显示AI的回复。
*   **多轮追问**：
    *   在弹出的窗口中，可以直接输入文字进行追问，或粘贴图片、拖拽文件上传（需模型支持）。
    *   根据“通用设置”中的 `Ctrl+Enter 发送` 选项，按下 `Ctrl+Enter` 或 `Enter` 键发送问题。
*   **窗口管理**：
    *   窗口大小和位置：可以点击模型名称左侧的图标来更新当前默认的窗口大小和位置。
    *   智能关闭：根据“通用设置”中的 `失焦时自动关闭窗口` 选项，窗口可以在失去焦点后自动关闭。在窗口右上角，也可以单独为当前窗口设置此项。
*   **对话保存与加载**：
    *   点击右上角对话保存按钮，可以将当前对话保存为 JSON 文件。
    *   选中保存的 JSON 文件，调用“恢复聊天”功能，继续之前的对话。在任一窗口模式上传保存的对话记录，都能够将当前窗口恢复为对话记录中的状态。
    *   继续对话将不会更改已保存的对话记录，注意保存新的对话记录防止数据丢失。

![独立窗口模式展示](image/t8.png)
*图示：独立窗口模式下的独立的对话窗口，展示多轮对话和窗口操作。*

---

## ⚠️ 常见问题与注意事项

1.  **虚拟机兼容性**：Anywhere 依赖 Utools 内置的 API 实现模拟输入功能。在虚拟机环境中使用时，可能会出现兼容性问题，甚至导致文本重复，因此**不建议在虚拟机中运行**。
2.  **Markdown 输出冲突**：AI 默认回复通常遵循 Markdown 格式。然而，多数 Markdown 编辑器会自动补全用户输入格式（例如，在列表末尾换行时自动增加序号），这可能与 AI 的 Markdown 回复产生冲突。当选择 `输入框` 输出模式时，如果遇到此类问题，建议切换到 Markdown 编辑器的**源码模式**进行输入。
3.  **独立窗口与设置**：当在设置中开启“自动分离为独立窗口”功能时，在文本生成过程中，设置界面可能无法关闭，请注意此行为。
4.  **文件上传报错**：请确保上传的文件类型受当前所选的AI模型支持。如果模型不支持该文件类型，Anywhere 将会报错。