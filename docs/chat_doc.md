# 历史对话 💬(Chat History) 使用说明文档

**文档更新时间：2026年1月28日**

欢迎使用 **Anywhere** 智能助手。本模块旨在帮助您高效管理、备份及同步您与 AI 的所有对话记录。通过强大的本地与云端（WebDAV）协同机制，您可以确保数据在多设备间无缝流转，同时保障数据的安全性与私密性。

---

## 1. 核心概念

在使用历史对话功能前，请先理解以下两种视图模式的区别：

### 📂 本地对话 (Local Chats)

* **定义**：存储在您当前设备硬盘上的对话记录。
* **存储机制**：Anywhere 会每隔 **15秒** 自动将**当前活跃且已命名**的对话保存到您指定的本地目录中，对话在每次请求与AI回复后立刻更新并保存。
* **文件格式**：所有对话均以标准的 `.json` 格式存储，包含了对话历史、模型基本配置（不涉及隐私）及上下文设置。
* **依赖条件**：需要在「设置」页面配置“本地对话路径”。

### ☁️ 云端对话 (Cloud Chats)

* **定义**：存储在您配置的 WebDAV 服务器上的对话备份。
* **用途**：用于跨设备同步。例如，您在公司电脑保存的对话上传后，可以在家里电脑下载并继续对话。
* **依赖条件**：需要在「设置」页面正确配置 WebDAV 服务信息。

### 👌 恢复对话 (Resume Chats)

* **定义**：将存储的json对话恢复并继续聊天
* **用途**：用于继续之前保存的对话/打开其他人分享的对话
* **依赖条件**：无

---

## 2. 界面与操作指南

### 2.1 视图切换

在页面上方，您可以通过点击单选按钮在 **“本地对话”** 和 **“云端对话”** 之间切换。

* 若未配置 WebDAV，云端视图将不可用。
* 若未配置本地路径，本地视图将显示为空并在页面提示配置。

### 2.2 数据同步

Anywhere 提供了智能的双向同步功能，按钮位于右上角：

* **📤 上传变更 (蓝色角标)**：
  * **功能**：检测到本地有新文件或比云端更新的文件时，角标会显示数量。点击可批量将这些文件上传至云端。
* **📥 下载变更 (绿色角标)**：
  * **功能**：检测到云端有新文件或比本地更新的文件时，角标会显示数量。点击可批量将这些文件拉取到本地。
* **强制同步 (单个文件)**：
  * 在文件列表中，点击操作栏的 **同步 (Sync)** 按钮，可强制将当前版本覆盖到另一端（例如在本地视图点击，则强制覆盖云端文件）。

### 2.3 文件管理

* **进入对话**：点击 **“聊天 (Chat)”** 按钮，即可立即加载该历史记录并恢复当时的上下文环境（包括模型、插件设置等）。
* **重命名**：点击 **“重命名 (Rename)”**。
  * *智能提示*：如果系统检测到另一端（云端/本地）存在同名文件，会询问是否同步重命名，保持两端一致。
* **删除**：点击 **“删除 (Delete)”**。
  * *智能提示*：删除时，系统会检查另一端是否存在该文件，并询问是否一并删除，防止残留垃圾文件。
* **批量操作**：勾选列表左侧的复选框，可使用底部的“批量删除”功能。

### 2.4 自动清理 (Auto Clean)

随着使用时间增加，历史记录可能会变得杂乱。点击右上角的 **🧹 (清理)** 按钮：

1. **选择范围**：选择保留的时间范围（如：保留最近3天、7天、30天，或自定义天数）。
2. **预览**：系统会自动计算将要删除的文件数量及释放的空间大小。
3. **确认**：点击确认后，系统将批量删除**当前视图**下过期的旧文件（注意：此操作不会同步删除另一端文件，以防误删）。

---

## 3. 对话的保存与导出

在对话窗口（独立窗口）中，您可以通过以下方式生成历史记录：

1. **自动保存**：只要您在「设置」中开启了“全局自动保存对话”，且配置了本地路径，对话会自动保存为 JSON 文件。
2. **手动保存/另存为**：
   * 点击标题栏右侧的 **下载图标**，或使用快捷键 `Ctrl + S`。
   * **保存为 JSON**：用于日后在 Anywhere 中恢复对话。
   * **保存为 Markdown**：导出为文本格式，适合阅读、分享或发布到博客。支持代码块、数学公式及图片引用的保留。
   * **保存为 HTML**：导出为网页格式，完美复刻对话界面的样式，包含头像、时间戳和多媒体展示。
   * **保存到云端**：直接将当前对话状态推送到 WebDAV，无需经过本地文件系统。

---

## 4. 常见问题 (FAQ)

**Q1: 为什么我看不到“本地对话”列表？**

> **A:** 请检查您是否在「设置 -> 数据管理」中配置了 **“本地对话路径”**。该路径必须是一个存在的文件夹。如果是首次使用，建议创建一个名为 `Anywhere_Chats` 的专用文件夹。

**Q2: 为什么“云端对话”无法点击或显示为空？**

> **A:** 请确保您在「设置 -> WebDAV」中正确填写了 URL、用户名、密码以及数据路径（默认为 `/anywhere_data`）。您可以点击设置页面的“管理备份”来测试连接是否正常。

**Q3: 我在 A 电脑上删除了一个对话，B 电脑上还会存在吗？**

> **A:** 如果您仅删除了 A 电脑的本地文件且未同步删除云端文件，B 电脑同步时可能会再次从云端拉取该文件。建议在删除时留意系统的询问弹窗，选择“同步删除”以保持各端整洁。

**Q4: 自动保存的文件名是如何生成的？**

> **A:** 系统会根据您对话的第一条内容自动生成摘要，并附带时间戳，例如 `写一首诗-AI-20260128-1030.json`。您随时可以在历史列表中对其进行重命名。

**Q5: 导入的 JSON 文件格式有什么要求？**

> **A:** 必须是由 Anywhere 导出的标准 JSON 会话文件。虽然您可以手动编辑 JSON，但为了防止数据损坏，建议通过软件界面进行操作。

**Q6: 如果我重装了系统或 uTools，历史记录会丢失吗？**

> **A:**
>
> * **本地对话**：如果您将“本地对话路径”设置在非系统盘（如 D 盘）或云同步盘（如 OneDrive/iCloud）目录中，重装后重新指定该路径即可找回。
> * **云端对话**：只要 WebDAV 服务商的数据未丢失，重新配置 WebDAV 账号即可找回所有云端备份。

---

**如需更多帮助，请访问我们的开源社区或联系开发者。祝您使用愉快！**

[GITHUB开源项目 AI Anywhere](https://github.com/Komorebi-yaodong/Anywhere)
QQ群：1065512489
